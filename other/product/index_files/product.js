// AJAXvar productModule = {	module : PAMPIK.getModule('product', 'product/default'),	init : function() {},	ajax : function (method, data, callback) {		this.module.ajax(method, data, callback);	}};// S: TODO узнать у шахина как это сделать через стандартный модуль JSvar initProductPhoto = function () {	var modal = $('#photoModal'),		modalTitle = modal.find('.modal-title'),		modalArrowLeft = modal.find('.controll-arrows .left-arrow'),		modalArrowRight = modal.find('.controll-arrows .right-arrow'),		modalBody = modal.find('.modal-body'),		modalBodyImg = modalBody.find('img'),		modalPhotoList = modal.find('.sub-photos ul li'),		lastItemId = modalPhotoList.length,		photoList = $('.sub-photos ul li'),		photoContainer = $('.photo-main');	// TODO restyle element so it become clickable	//$('.photo-main::after').click( $(".photo-main").click );	photoContainer.click(function () {		var img = $(this).find('img');		updatePhoto (modalBodyImg, img.data('image'), img.attr('src'), 'big');		modalTitle.html(img.attr('alt'));	});	photoList.click(function () {		var li = $(this),			id = li.data('image'),			src = li.find("img").attr("src");		photoList.removeClass('active').filter('[data-image="' + id +'"]').addClass('active');		updatePhoto (photoContainer.find('img'), id, src, 'middle');		updatePhoto (modalBodyImg, id, src, 'big');	});	// TODO add cursor style	modalBody.click(function(){		modalArrowRight.click()	});	modalArrowLeft.click(function () {		switchProductPhoto( modalBodyImg.data('image') - 1 );	});	modalArrowRight.click(function () {		switchProductPhoto( modalBodyImg.data('image') + 1 );	});	function switchProductPhoto ( id ) {		modalPhotoList.filter('[data-image="' + ( ( id <= lastItemId ) * (id > 0) * id + ( id == 0) * lastItemId + ( id > lastItemId ) ) +'"]').click();	}	function updatePhoto (img, id, src, size) {		img			.data('image', id)			.attr("src", src.replace('/pic/','/'+ size +'/').replace('/middle/','/'+ size +'/'));	}	return this;}// E: TODO узнать у шахина как это сделать через стандартный модуль JSfunction variantProcess(id){	productModule.ajax('GetProductVariantById',{'id':id},function(d) {		$('#photoModal').remove();		$('.photo-container').html(d.html);		$('#product-article').html(d.id);		initProductPhoto();	});}/**** */function init() {}$(function() {	productModule.init();	console.info('product-js');	var variantBaseId = $('.product-is-base-variant :selected').val();	if ( $('.sub-product-attribute').length ) {		$('.sub-product-attribute').hide();		$('#sub-attribute-'+variantBaseId).show();	}	$('.product-is-base-variant').on('change',function(){		$('.sub-product-attribute').hide();		$('#sub-attribute-'+$(this).val()).show();		var pID = $('#sub-attribute-'+$(this).val()+' :selected').data('product-id');		if(pID == undefined) {			pID = $(this).find(':selected').data('product-id');		}		console.info('.product-is-base-variant pID : ' + pID );		variantProcess(pID);	});	if ( $('.sub-product-attribute').length ) {		$('.product-is-sub-variant').on('change',function(){			$('#sub-attribute-'+$(this).val()).show();			var pID = $(this).find(':selected').data('product-id');			variantProcess(pID);		});	}});